<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-devops-guide/reservation" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Reservation System setup - 配置会议预订系统 | Jitsi Meet</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://civiccccc.ltd/handbook/img/undraw_online.svg"><meta data-rh="true" name="twitter:image" content="https://civiccccc.ltd/handbook/img/undraw_online.svg"><meta data-rh="true" property="og:url" content="https://civiccccc.ltd/handbook/docs/devops-guide/reservation"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Reservation System setup - 配置会议预订系统 | Jitsi Meet"><meta data-rh="true" name="description" content="Support for a reservation system over REST API"><meta data-rh="true" property="og:description" content="Support for a reservation system over REST API"><link data-rh="true" rel="icon" href="/handbook/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://civiccccc.ltd/handbook/docs/devops-guide/reservation"><link data-rh="true" rel="alternate" href="https://civiccccc.ltd/handbook/docs/devops-guide/reservation" hreflang="en"><link data-rh="true" rel="alternate" href="https://civiccccc.ltd/handbook/docs/devops-guide/reservation" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://K2ODL876OV-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Jitsi Meet" href="/handbook/opensearch.xml"><link rel="stylesheet" href="/handbook/assets/css/styles.33cde50c.css">
<script src="/handbook/assets/js/runtime~main.ed123826.js" defer="defer"></script>
<script src="/handbook/assets/js/main.b06072b5.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/handbook/"><div class="navbar__logo"><img src="/handbook/img/logo.svg" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/handbook/img/logo.svg" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Jitsi Meet Handbook</b></a><a class="navbar__item navbar__link" href="/handbook/docs/intro">Docs - 文档</a><a class="navbar__item navbar__link" href="/handbook/docs/category/sdks">SDKs</a><a class="navbar__item navbar__link" href="/handbook/docs/releases">Releases - 发布</a><a href="https://community.jitsi.org" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Community - 社区<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://jaas.8x8.vc" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">JaaS<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/jitsi" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/handbook/docs/intro">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/handbook/docs/community/community-intro">Community</a><button aria-label="Expand sidebar category &#x27;Community&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/handbook/docs/category/user-guide">User Guide</a><button aria-label="Expand sidebar category &#x27;User Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/handbook/docs/category/developer-guide">Developer Guide</a><button aria-label="Expand sidebar category &#x27;Developer Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/handbook/docs/devops-guide/">Self-Hosting Guide</a><button aria-label="Collapse sidebar category &#x27;Self-Hosting Guide&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/handbook/docs/category/deployment">Deployment</a><button aria-label="Expand sidebar category &#x27;Deployment&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/handbook/docs/category/configuration">Configuration</a><button aria-label="Collapse sidebar category &#x27;Configuration&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/handbook/docs/devops-guide/secure-domain">Authentication (Secure Domain) - 认证（安全域）</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/handbook/docs/devops-guide/ldap-authentication">LDAP 认证</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/handbook/docs/devops-guide/devops-guide-scalable">Scalable setup - 可扩展性配置</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/handbook/docs/devops-guide/reservation">Reservation System - 会议预订系统</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/handbook/docs/devops-guide/turn">TURN setup - 设置 TURN 服务器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/handbook/docs/devops-guide/speakerstats">Speaker Stats - 启用发言者统计</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/handbook/docs/devops-guide/videosipgw">Video SIP gateway - 视频SIP网关</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/handbook/docs/devops-guide/cloud-api">Cloud API</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/handbook/docs/devops-guide/devops-guide-videotutorials">Video Tutorials - 视频教学</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/handbook/docs/devops-guide/faq">FAQ - 常见问题解答</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/handbook/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/handbook/docs/devops-guide/"><span itemprop="name">Self-Hosting Guide</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/handbook/docs/category/configuration"><span itemprop="name">Configuration</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Reservation System - 会议预订系统</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Reservation System setup - 配置会议预订系统</h1></header><h3 class="anchor anchorWithStickyNavbar_LWe7" id="support-for-a-reservation-system-over-rest-api">Support for a reservation system over REST API<a href="#support-for-a-reservation-system-over-rest-api" class="hash-link" aria-label="Direct link to Support for a reservation system over REST API" title="Direct link to Support for a reservation system over REST API">​</a></h3>
<p>It is possible to connect to an external conference reservation system using a
REST API. Before a new Jitsi Meet conference is created, the reservation system will be
queried for room availability. The system is supposed to return a positive or
negative response code, which also contains conference duration. Prosody will enforce
conference duration and if the time limit is exceeded the conference will be
terminated.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="enable-reservation-system">Enable reservation system<a href="#enable-reservation-system" class="hash-link" aria-label="Direct link to Enable reservation system" title="Direct link to Enable reservation system">​</a></h4>
<p>In order to enable the reservation system, the URL base for the REST API endpoint must be
configured. Under the main virtual host in prosody, enable module &quot;reservations&quot; and
add the config <code>reservations_api_prefix</code>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">VirtualHost &quot;jitmeet.example.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -- ....</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    modules_enabled = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        -- ....</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;reservations&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reservations_api_prefix = &quot;http://reservation.example.com&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The URL base is used to construct the request URL. Currently, only <code>&#x27;/conference&#x27;</code>
endpoint is supported, so all request will go to:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">http://reservation.example.com/conference</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Additional configuration options are available:</p>
<ul>
<li>&quot;reservations_api_timeout&quot; to change API call timeouts (defaults to 20 seconds)</li>
<li>&quot;reservations_api_headers&quot; to specify custom HTTP headers included in
all API calls e.g. to provide auth tokens.</li>
<li>&quot;reservations_api_retry_count&quot; to specify the number of times API call failures are retried (defaults to 3)</li>
<li>&quot;reservations_api_retry_delay&quot; seconds to wait between retries (defaults to 3s)</li>
<li>&quot;reservations_api_should_retry_for_code&quot; as a function that takes an HTTP response code and
returns true if the API call should be retried. By default, retries are done for 5XX
responses. Timeouts are never retried, and HTTP call failures are always retried.</li>
<li>&quot;reservations_enable_max_occupants&quot; to enable support for setting max occupants. If this is set to <code>true</code>, and if
the API response payload includes a &quot;max_occupants&quot; value, then that value will be set as the max occupancy limit
for that specific room.<!-- -->
<ul>
<li>&quot;muc_max_occupants&quot; module must also be enabled for this to work.</li>
</ul>
</li>
<li>&quot;reservations_enable_lobby_support&quot; to enable support for lobby. If this is set to <code>true</code>, and if
the API response payload includes a &quot;lobby&quot; field set to <code>true</code> , then the lobby will be enabled for the room.<!-- -->
<ul>
<li>&quot;muc_lobby_rooms&quot; and &quot;persistent_lobby&quot; modules must also be enabled for this to work.</li>
</ul>
</li>
<li>&quot;reservations_enable_password_support&quot; to enable support for room password. If this is set to <code>true</code>, and if
the API response payload includes a &quot;password&quot; value, then that value will be set as room password. Users will then
be required to know that password to be able to join the room, or in the case where lobby is enabled, can use the
password to bypass the lobby.</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --- The following are all optional</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reservations_api_headers = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        [&quot;Authorization&quot;] = &quot;Bearer TOKEN-237958623045&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reservations_api_timeout = 10  -- timeout if API does not respond within 10s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reservations_api_retry_count = 5  -- retry up to 5 times</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reservations_api_retry_delay = 1  -- wait 1s between retries</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reservations_api_should_retry_for_code = function (code)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return code &gt;= 500 or code == 408</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reservations_enable_max_occupants = true -- enable integration with muc_max_occupants</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reservations_enable_lobby_support = true -- enable integration with muc_lobby_rooms</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reservations_enable_password_support = true -- enable support for setting room passwords</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="call-flow">Call flow<a href="#call-flow" class="hash-link" aria-label="Direct link to Call flow" title="Direct link to Call flow">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="notes">Notes<a href="#notes" class="hash-link" aria-label="Direct link to Notes" title="Direct link to Notes">​</a></h5>
<p>All API calls use the following datetime format:</p>
<p><code>yyyy-MM-dd&#x27;T&#x27;HH:mm:ss.SSSX</code> - more info can be found in
<code>SimpleDateFormat</code> <a href="https://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html" target="_blank" rel="noopener noreferrer">JavaDoc</a></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="conference-allocation">Conference allocation<a href="#conference-allocation" class="hash-link" aria-label="Direct link to Conference allocation" title="Direct link to Conference allocation">​</a></h5>
<p>When the first user joins a MUC room (i.e. Jitsi Meet URL is opened), an <code>HTTP POST</code>
request is sent to <code>&#x27;/conference&#x27;</code> endpoint with the following parameters
included:</p>
<ul>
<li><code>name (string)</code> - short name of the conference room (not full MUC address). If tenant is used, the name will be <code>[tenant]roomname</code>.</li>
<li><code>start_time (string)</code> - conference start date and time</li>
<li><code>mail_owner (string)</code> - if authentication system is enabled this field will
contain user&#x27;s identity. It that case it will not be possible to create a new
conference room without authenticating.</li>
</ul>
<p>The payload sent to the endpoint will be encoded as <code>application/x-www-form-urlencoded</code>.</p>
<p>The reservation system is expected to respond with one of the following
responses:</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="http-200-or-201-conference-created-successfully">HTTP 200 or 201 Conference created successfully<a href="#http-200-or-201-conference-created-successfully" class="hash-link" aria-label="Direct link to HTTP 200 or 201 Conference created successfully" title="Direct link to HTTP 200 or 201 Conference created successfully">​</a></h6>
<p>In the HTTP response, a JSON object is expected. It should contain conference <code>id</code>
assigned by the system and <code>duration</code> measured in seconds. Sample response body:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;id&quot;: 364758328,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot;: &quot;conference1234&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;mail_owner&quot;: &quot;user@server.com&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;start_time&quot;: &quot;2048-04-20T17:55:12.000Z&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;duration&quot;: 900000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The object can optionally include a <code>max_occupants</code> key with an integer value. When provided, and if
<code>reservations_enable_max_occupants</code> is enabled, then the value will be passed to muc_mod_max_occupants to enforce
per-room occupancy limits.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="通过rest-api支持会议预订系统">通过REST API支持会议预订系统<a href="#通过rest-api支持会议预订系统" class="hash-link" aria-label="Direct link to 通过REST API支持会议预订系统" title="Direct link to 通过REST API支持会议预订系统">​</a></h3>
<p>可以通过REST API连接到外部会议预订系统。在创建新的Jitsi Meet会议之前，系统将查询预订系统以获取房间可用性。系统应返回一个正或负的响应代码，同时包含会议持续时间。Prosody将强制执行会议持续时间，如果超出时间限制，会议将被终止。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="启用预订系统">启用预订系统<a href="#启用预订系统" class="hash-link" aria-label="Direct link to 启用预订系统" title="Direct link to 启用预订系统">​</a></h4>
<p>为了启用预订系统，必须配置REST API端点的基本URL。在Prosody的主虚拟主机下，启用“reservations”模块并添加配置 <code>reservations_api_prefix</code>：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">VirtualHost &quot;jitmeet.example.com&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -- ....</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    modules_enabled = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        -- ....</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;reservations&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reservations_api_prefix = &quot;http://reservation.example.com&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>该URL基本用于构建请求URL。目前，仅支持<code>&#x27;/conference&#x27;</code>端点，因此所有请求将发送到：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">http://reservation.example.com/conference</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>可用的其他配置选项包括：</p>
<ul>
<li>&quot;reservations_api_timeout&quot;：更改API调用超时（默认为20秒）</li>
<li>&quot;reservations_api_headers&quot;：指定所有API调用中包含的自定义HTTP头，例如提供身份验证令牌。</li>
<li>&quot;reservations_api_retry_count&quot;：指定API调用失败时的重试次数（默认为3）</li>
<li>&quot;reservations_api_retry_delay&quot;：重试之间等待的秒数（默认为3秒）</li>
<li>&quot;reservations_api_should_retry_for_code&quot;：一个函数，接受HTTP响应代码并返回true，如果API调用应重试。默认情况下，对5XX响应进行重试。超时不会重试，HTTP调用失败将始终重试。</li>
<li>&quot;reservations_enable_max_occupants&quot;：启用设置最大占用人数的支持。如果设置为<code>true</code>，并且API响应有效负载中包含“max_occupants”值，则该值将被设置为该特定房间的最大占用限制。<!-- -->
<ul>
<li>必须启用“muc_max_occupants”模块以使其工作。</li>
</ul>
</li>
<li>&quot;reservations_enable_lobby_support&quot;：启用大厅的支持。如果设置为<code>true</code>，并且API响应有效负载中包含一个“lobby”字段，设置为<code>true</code>，则将为房间启用大厅。<!-- -->
<ul>
<li>必须启用“muc_lobby_rooms”和“persistent_lobby”模块以使其工作。</li>
</ul>
</li>
<li>&quot;reservations_enable_password_support&quot;：启用房间密码的支持。如果设置为<code>true</code>，并且API响应有效负载中包含一个“password”值，则该值将被设置为房间密码。用户将需要知道该密码才能加入房间，或者在启用大厅的情况下，可以使用该密码绕过大厅。</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --- The following are all optional 以下都是可选项</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reservations_api_headers = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        [&quot;Authorization&quot;] = &quot;Bearer TOKEN-237958623045&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reservations_api_timeout = 10  -- timeout if API does not respond within 10s 如果API在10秒内没有响应则超时</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reservations_api_retry_count = 5  -- retry up to 5 times 最多重试5次</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reservations_api_retry_delay = 1  -- wait 1s between retries 重试之间等待1秒</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reservations_api_should_retry_for_code = function (code)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return code &gt;= 500 or code == 408</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reservations_enable_max_occupants = true -- enable integration with muc_max_occupants 启用与muc_max_occupants的集成</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reservations_enable_lobby_support = true -- enable integration with muc_lobby_rooms 启用与muc_lobby_rooms的集成</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reservations_enable_password_support = true -- enable support for setting room passwords 启用设置房间密码的支持</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="调用流程">调用流程<a href="#调用流程" class="hash-link" aria-label="Direct link to 调用流程" title="Direct link to 调用流程">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="注意">注意<a href="#注意" class="hash-link" aria-label="Direct link to 注意" title="Direct link to 注意">​</a></h5>
<p>所有API调用使用以下日期时间格式：</p>
<p><code>yyyy-MM-dd&#x27;T&#x27;HH:mm:ss.SSSX</code> - 更多信息可以在<code>SimpleDateFormat</code> <a href="https://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html" target="_blank" rel="noopener noreferrer">JavaDoc</a>中找到。</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="会议分配">会议分配<a href="#会议分配" class="hash-link" aria-label="Direct link to 会议分配" title="Direct link to 会议分配">​</a></h5>
<p>当第一个用户加入MUC房间（即打开Jitsi Meet URL）时，将向<code>&#x27;/conference&#x27;</code>端点发送一个<code>HTTP POST</code>请求，并包含以下参数：</p>
<ul>
<li><code>name (string)</code> - 会议室的简短名称（不是完整的MUC地址）。如果使用租户，名称将为<code>[tenant]roomname</code>。</li>
<li><code>start_time (string)</code> - 会议开始的日期和时间</li>
<li><code>mail_owner (string)</code> - 如果启用了身份验证系统，该字段将包含用户的身份。在这种情况下，将无法在未进行身份验证的情况下创建新的会议室。</li>
</ul>
<p>发送到端点的有效负载将以<code>application/x-www-form-urlencoded</code>编码。</p>
<p>预订系统应以以下响应之一进行响应：</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="http-200-或-201-会议创建成功">HTTP 200 或 201 会议创建成功<a href="#http-200-或-201-会议创建成功" class="hash-link" aria-label="Direct link to HTTP 200 或 201 会议创建成功" title="Direct link to HTTP 200 或 201 会议创建成功">​</a></h6>
<p>在HTTP响应中，期望一个JSON对象。它应包含系统分配的会议<code>id</code>和以秒为单位的<code>duration</code>。示例响应主体：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;id&quot;: 364758328,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot;: &quot;conference1234&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;mail_owner&quot;: &quot;user@server.com&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;start_time&quot;: &quot;2048-04-20T17:55:12.000Z&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;duration&quot;: 900000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>该对象可以选择性地包含一个<code>max_occupants</code>键，其值为整数。当提供时，如果启用了<code>reservations_enable_max_occupants</code>，则该值将传递给muc_mod_max_occupants以强制执行每个房间的占用限制。</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="http-409---会议已存在">HTTP 409 - 会议已存在<a href="#http-409---会议已存在" class="hash-link" aria-label="Direct link to HTTP 409 - 会议已存在" title="Direct link to HTTP 409 - 会议已存在">​</a></h6>
<p>这是为了从之前的失败中恢复。如果由于某种原因会议被重启，而用户尝试再次创建房间，则该响应通知Prosody会议室已经存在。预计JSON响应主体中会包含 <code>conflict_id</code>：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;conflict_id&quot;: 364758328</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Prosody将使用 <code>HTTP GET</code> 请求获取有关给定 <code>conflict_id</code> 的冲突会议的信息。有关此请求的更多信息，请参见“读取会议信息”部分。</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="http-4xx">HTTP 4xx<a href="#http-4xx" class="hash-link" aria-label="Direct link to HTTP 4xx" title="Direct link to HTTP 4xx">​</a></h6>
<p>其他响应代码将导致会议创建失败。JSON响应可以包含一个 <code>message</code> 对象，该对象将返回给客户端。</p>
<p>例如，<code>user1</code> 尝试通过向Jicofo发送 <code>conference</code> IQ 来启动新的会议。系统将拒绝该请求。</p>
<p>客户端 -&gt; Jicofo：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;iq from=&#x27;client1@xmpp.com&#x27; to=&#x27;jicofo.meet.com&#x27; type=&#x27;set&#x27;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &lt;conference xmlns=&#x27;http://jitsi.org/protocol/focus&#x27; room=&#x27;testroom1&#x27; /&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;/iq&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Prosody -&gt; 会议预订系统：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">POST /conference HTTP/1.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">content-type:application/x-www-form-urlencoded;charset=utf-8</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">host: http://reservation.example.com</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">content-length: length</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">name=testroom1&amp;start_time=2048-04-20T17%3A55%3A12.000Z&amp;mail_owner=client1%40xmpp.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>会议预订系统 -&gt; Prosody：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">HTTP/1.1 403 Forbidden</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Content-Type: application/json; charset=utf-8</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Content-Length: length</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;message&quot;: &quot;client1 is not allowed to create the room at this time&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Prosody -&gt; 客户端：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;iq from=&#x27;jicofo.meet.com&#x27; to=&#x27;client1@xmpp.com&#x27; type=&#x27;error&#x27;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &lt;error type=&#x27;cancel&#x27;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;service-unavailable xmlns=&#x27;urn:ietf:params:xml:ns:xmpp-stanzas&#x27; /&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;text xmlns=&#x27;urn:ietf:params:xml:ns:xmpp-stanzas&#x27;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          client1 is not allowed to create the room at this time</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;/text&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;reservation-error xmlns=&#x27;http://jitsi.org/protocol/focus&#x27; error-code=&#x27;403&#x27;/&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &lt;/error&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;/iq&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>该应用程序可以使用 <code>text</code> 和 <code>reservation-error</code> 元素向用户提供有意义的信息。</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="读取会议信息">读取会议信息<a href="#读取会议信息" class="hash-link" aria-label="Direct link to 读取会议信息" title="Direct link to 读取会议信息">​</a></h5>
<p>如果 <code>HTTP POST</code> 请求的响应为 <code>409</code>，Prosody将尝试使用 <code>HTTP GET</code> 请求 <code>/conference/{conflict_id}</code> 端点读取冲突会议的信息。响应应提供存储在预订系统中的会议的所有信息：</p>
<ul>
<li><code>&quot;id&quot;</code>：预订系统分配的会议标识符</li>
<li><code>&quot;name&quot;</code>：会议室名称</li>
<li><code>&quot;mail_owner&quot;</code>：创建会议的用户身份</li>
<li><code>&quot;start_time&quot;</code>：会议开始的日期和时间</li>
<li><code>&quot;duration&quot;</code>：计划的会议持续时间（以秒为单位）</li>
</ul>
<p>如果适用，还应提供可选的 <code>max_occupants</code> 值。</p>
<p>示例响应JSON主体（包含与对 <code>HTTP POST</code> 的 <code>200 OK</code> 相同的信息）：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;id&quot;: 364758328,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot;: &quot;conference1234&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;mail_owner&quot;: &quot;user@server.com&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;start_time&quot;: &quot;2048-04-20T17:55:12.000Z&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;duration&quot;: 900000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="删除会议">删除会议<a href="#删除会议" class="hash-link" aria-label="Direct link to 删除会议" title="Direct link to 删除会议">​</a></h5>
<p>Prosody在两种情况下删除预订系统中的会议。首先是在所有用户离开XMPP多用户聊天房间时。其次是在会议持续时间限制超出时。在后一种情况下，Prosody将销毁XMPP MUC房间。MUC房间销毁后，Prosody将向 <code>&#x27;/conference/{id}&#x27;</code> 端点发送 <code>HTTP DELETE</code> 请求，其中 <code>{id}</code> 替换为预订系统分配的会议标识符。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">DELETE /conference/364758328 HTTP/1.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">host: http://reservation.example.com</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="实施图">实施图<a href="#实施图" class="hash-link" aria-label="Direct link to 实施图" title="Direct link to 实施图">​</a></h4>
<p><img decoding="async" loading="lazy" src="/handbook/assets/images/reservation-api-3e18d6acf620327d83e4e6deb021c1a9.png" width="3506" height="2480" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/jitsi/handbook/edit/master/docs/devops-guide/reservation.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-10-15T15:38:09.000Z" itemprop="dateModified">Oct 15, 2024</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/handbook/docs/devops-guide/devops-guide-scalable"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Scalable setup - 可扩展性配置</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/handbook/docs/devops-guide/turn"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">TURN setup - 设置 TURN 服务器</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#support-for-a-reservation-system-over-rest-api" class="table-of-contents__link toc-highlight">Support for a reservation system over REST API</a></li><li><a href="#通过rest-api支持会议预订系统" class="table-of-contents__link toc-highlight">通过REST API支持会议预订系统</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/handbook/docs/intro">Introduction - 概述</a></li><li class="footer__item"><a class="footer__link-item" href="/handbook/docs/category/user-guide">User Guide - 用户指南</a></li><li class="footer__item"><a class="footer__link-item" href="/handbook/docs/category/developer-guide">Developer Guide - 开发者指南</a></li><li class="footer__item"><a class="footer__link-item" href="/handbook/docs/devops-guide">Self-Hosting Guide - 自 托管指南</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community - 社区</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://community.jitsi.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum - 论坛<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/jitsinews" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More - 更多</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://jitsi.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog - 博客<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/jitsi" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://jaas.8x8.vc" target="_blank" rel="noopener noreferrer" class="footer__link-item">JaaS: Jitsi as a Service<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://8x8.com" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/handbook/img/8x8-copyright-icon.svg" alt="8x8 Footer Logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/handbook/img/8x8-copyright-icon.svg" alt="8x8 Footer Logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></a></div><div class="footer__copyright">Copyright © 8x8, Inc.</div></div></div></footer></div>
</body>
</html>